<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
	xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" 
	xmlns:cache="http://www.springframework.org/schema/cache" xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd  
            http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.3.xsd  
            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd  
            http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache-4.3.xsd  
            http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.3.xsd"
	default-autowire="byName" default-lazy-init="true">

	<bean id="mySecurityFilterChainProxy" class="org.springframework.security.web.FilterChainProxy">
		<constructor-arg>
			<list>
			 	<ref bean="defaultSecurityFilterChain" />
			</list>
		</constructor-arg>
	</bean>

	<bean id="defaultSecurityFilterChain" class="org.springframework.security.web.DefaultSecurityFilterChain">
		<constructor-arg index="0">
			<ref bean="antPathRequestMatcher" />
		</constructor-arg>
		<constructor-arg index="1">
			<list>
				<ref bean="securityContextPersistenceFilter" />
				<ref bean="concurrentSessionFilter" />			
				<ref bean="csrfFilter" />
				<ref bean="logoutFilter" />
													
			</list>
		</constructor-arg>
	</bean>

	<bean id="antPathRequestMatcher" class="org.springframework.security.web.util.matcher.AntPathRequestMatcher">
		<constructor-arg index="0">
			<value>/modules/**</value>
		</constructor-arg>
	</bean>

	<bean id="channelProcessingFilter" class="org.springframework.security.web.access.channel.ChannelProcessingFilter">
	
	</bean>
	<bean id="channelDecisionManager" class="org.springframework.security.web.access.channel.ChannelDecisionManagerImpl">
		
	</bean>
		
	<bean id="securityContextPersistenceFilter" class="org.springframework.security.web.context.SecurityContextPersistenceFilter">
		<constructor-arg index="0">
			<ref bean="repo" />
		</constructor-arg>
	</bean>
	<bean id="repo" class="org.springframework.security.web.context.HttpSessionSecurityContextRepository">

	</bean>	
	
	<bean id="concurrentSessionFilter" class="org.springframework.security.web.session.ConcurrentSessionFilter">
		<constructor-arg index="0">
			<ref bean="sessionRegistry" />
		</constructor-arg>
	</bean>
	<bean id="sessionRegistry" class="org.springframework.security.core.session.SessionRegistryImpl">
		
	</bean>	
		
	<bean id="headerWriterFilter" class="org.springframework.security.web.header.HeaderWriterFilter">
	
	</bean>	
	<bean id="csrfFilter" class="org.springframework.security.web.csrf.CsrfFilter">
		<constructor-arg index="0">
			<ref bean="tokenRepository" />
		</constructor-arg>	
	</bean>	
	<bean id="tokenRepository" class="org.springframework.security.web.csrf.LazyCsrfTokenRepository">
		<constructor-arg index="0">
			<ref bean="delegateCsrfTokenRepository" />
		</constructor-arg>		
	</bean>
	<bean id="delegateCsrfTokenRepository" class="org.springframework.security.web.csrf.HttpSessionCsrfTokenRepository">
	
	</bean>
	
	
	<bean id="logoutFilter" class="org.springframework.security.web.authentication.logout.LogoutFilter">
		<constructor-arg index="0">
			<ref bean="logoutSuccessHandler" />
		</constructor-arg>
		<constructor-arg index="1">
			<ref bean="compositeLogoutHandler" />
		</constructor-arg>
		<property name="logoutRequestMatcher" ref="logoutUrl"/>			
	</bean>	
	<bean id="logoutSuccessHandler" class="org.springframework.security.web.authentication.logout.SimpleUrlLogoutSuccessHandler">
	 		<property name="defaultTargetUrl" value="/modules/user/logout.jsp"/>
	</bean>

	<bean id="logoutUrl" class="org.springframework.security.web.util.matcher.AntPathRequestMatcher">
		<constructor-arg index="0">
			<value>"/modules/user/logout"</value>
		</constructor-arg>
		<constructor-arg index="1">
			<value>POST</value>
		</constructor-arg>		
	</bean>
	<bean id="csrfLogoutHandler" class="org.springframework.security.web.csrf.CsrfLogoutHandler">
		<constructor-arg index="0">
			<ref bean="tokenRepository" />
		</constructor-arg>	
	</bean>	
	<bean id="securityContextLogoutHandler" class="org.springframework.security.web.authentication.logout.SecurityContextLogoutHandler">
	
	</bean>	
	<bean id="tokenBasedRememberMeServices" class="org.springframework.security.web.authentication.rememberme.TokenBasedRememberMeServices">
	
	</bean>	
	<bean id="cookieClearingLogoutHandler" class="org.springframework.security.web.authentication.logout.CookieClearingLogoutHandler">
		<constructor-arg index="0">
			<value>"JSESSIONID"</value>
		</constructor-arg>
	</bean>
	<util:list id="compositeLogoutHandlerList"  list-class="java.util.ArrayList">
		<ref bean="csrfLogoutHandler" />
		<ref bean="securityContextLogoutHandler" />
		<ref bean="cookieClearingLogoutHandler" />
	</util:list>	
	<bean id="compositeLogoutHandler" class="org.springframework.security.web.authentication.logout.CompositeLogoutHandler">
		<constructor-arg index="0">
			<ref bean="compositeLogoutHandlerList" />
		</constructor-arg>	
	</bean>	

	
	
	
	
	<bean id="usernamePasswordAuthenticationFilter" class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
	
	</bean>







	<bean id="securityMetadataSource" class="org.example.users.services.impl.CustomSecurityMetadataSource">
		
	</bean>	

			
			
</beans>